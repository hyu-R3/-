<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>图书馆管理系统</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .navbar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .navbar-brand { color: white !important; font-weight: bold; }
    .nav-link { color: rgba(255,255,255,0.9) !important; }
    .card { border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; }
    .btn-primary:hover { background: linear-gradient(135deg, #764ba2 0%, #667eea 100%); }
    .login-container { min-height: 100vh; display: flex; align-items: center; justify-content: center; }
    .login-card { max-width: 400px; width: 100%; }
    .table-responsive { border-radius: 8px; overflow: hidden; }
    .book-cover { width: 100px; height: 140px; background: #e0e0e0; display: flex; align-items: center; justify-content: center; font-size: 2rem; color: #999; }
    .ranking-item { display: flex; align-items: center; padding: 15px; border-bottom: 1px solid #eee; }
    .ranking-number { width: 40px; height: 40px; border-radius: 50%; background: #667eea; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; }
    .ranking-item:nth-child(1) .ranking-number { background: #ffd700; }
    .ranking-item:nth-child(2) .ranking-number { background: #c0c0c0; }
    .ranking-item:nth-child(3) .ranking-number { background: #cd7f32; }
    .badge-available { background-color: #28a745; }
    .badge-unavailable { background-color: #dc3545; }
    .page-link { color: #667eea; }
    .page-item.active .page-link { background-color: #667eea; border-color: #667eea; }
  </style>
</head>
<body>
  <!-- 登录页面 -->
  <div id="loginPage" class="login-container">
    <div class="card login-card">
      <div class="card-header text-center py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <h3 class="text-white mb-0"><i class="bi bi-book me-2"></i>图书馆管理系统</h3>
      </div>
      <div class="card-body p-4">
        <ul class="nav nav-pills mb-4" id="authTabs" role="tablist">
          <li class="nav-item flex-fill">
            <button class="nav-link active w-100" data-bs-toggle="pill" data-bs-target="#login" type="button">登录</button>
          </li>
          <li class="nav-item flex-fill">
            <button class="nav-link w-100" data-bs-toggle="pill" data-bs-target="#register" type="button">注册</button>
          </li>
        </ul>
        <div class="tab-content">
          <!-- 登录表单 -->
          <div class="tab-pane fade show active" id="login">
            <form id="loginForm">
              <div class="mb-3">
                <label class="form-label">用户名</label>
                <input type="text" class="form-control" id="loginUsername" required>
              </div>
              <div class="mb-3">
                <label class="form-label">密码</label>
                <input type="password" class="form-control" id="loginPassword" required>
              </div>
              <button type="submit" class="btn btn-primary w-100">登录</button>
            </form>
          </div>
          <!-- 注册表单 -->
          <div class="tab-pane fade" id="register">
            <form id="registerForm">
              <div class="mb-3">
                <label class="form-label">用户名</label>
                <input type="text" class="form-control" id="regUsername" required>
              </div>
              <div class="mb-3">
                <label class="form-label">密码</label>
                <input type="password" class="form-control" id="regPassword" required>
              </div>
              <div class="mb-3">
                <label class="form-label">姓名</label>
                <input type="text" class="form-control" id="regName" required>
              </div>
              <div class="mb-3">
                <label class="form-label">邮箱</label>
                <input type="email" class="form-control" id="regEmail">
              </div>
              <div class="mb-3">
                <label class="form-label">电话</label>
                <input type="tel" class="form-control" id="regPhone">
              </div>
              <button type="submit" class="btn btn-primary w-100">注册</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 主页面 -->
  <div id="mainPage" style="display: none;">
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
      <div class="container">
        <a class="navbar-brand" href="#"><i class="bi bi-book me-2"></i>图书馆管理系统</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="showSection('books')">图书列表</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="showSection('myBorrows')">我的借阅</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="showSection('ranking')">借阅排行榜</a>
            </li>
          </ul>
          <span class="navbar-text text-white me-3" id="welcomeUser"></span>
          <button class="btn btn-outline-light btn-sm" onclick="logout()">退出</button>
        </div>
      </div>
    </nav>

    <div class="container">
      <!-- 图书列表 -->
      <div id="booksSection">
        <div class="row mb-4">
          <div class="col-md-8">
            <div class="input-group">
              <input type="text" class="form-control" id="searchInput" placeholder="搜索书名、作者或ISBN...">
              <button class="btn btn-primary" onclick="searchBooks()"><i class="bi bi-search"></i> 搜索</button>
            </div>
          </div>
          <div class="col-md-4 text-end">
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addBookModal">
              <i class="bi bi-plus-lg"></i> 图书入库
            </button>
          </div>
        </div>
        <div class="row" id="booksList"></div>
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center mt-4" id="pagination"></ul>
        </nav>
      </div>

      <!-- 我的借阅 -->
      <div id="myBorrowsSection" style="display: none;">
        <h3 class="mb-4"><i class="bi bi-bookmark me-2"></i>我的借阅记录</h3>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead class="table-light">
              <tr>
                <th>书名</th>
                <th>作者</th>
                <th>借阅日期</th>
                <th>应还日期</th>
                <th>状态</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody id="borrowsList"></tbody>
          </table>
        </div>
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center mt-4" id="borrowsPagination"></ul>
        </nav>
      </div>

      <!-- 借阅排行榜 -->
      <div id="rankingSection" style="display: none;">
        <h3 class="mb-4"><i class="bi bi-trophy me-2"></i>热门图书排行榜</h3>
        <div class="card">
          <div class="card-body" id="rankingList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- 图书入库模态框 -->
  <div class="modal fade" id="addBookModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">图书入库</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="addBookForm">
            <div class="mb-3">
              <label class="form-label">ISBN *</label>
              <input type="text" class="form-control" id="bookIsbn" required>
            </div>
            <div class="mb-3">
              <label class="form-label">书名 *</label>
              <input type="text" class="form-control" id="bookTitle" required>
            </div>
            <div class="mb-3">
              <label class="form-label">作者 *</label>
              <input type="text" class="form-control" id="bookAuthor" required>
            </div>
            <div class="mb-3">
              <label class="form-label">出版社</label>
              <input type="text" class="form-control" id="bookPublisher">
            </div>
            <div class="mb-3">
              <label class="form-label">出版日期</label>
              <input type="text" class="form-control" id="bookPublishDate" placeholder="YYYY-MM-DD">
            </div>
            <div class="mb-3">
              <label class="form-label">分类</label>
              <input type="text" class="form-control" id="bookCategory">
            </div>
            <div class="mb-3">
              <label class="form-label">数量 *</label>
              <input type="number" class="form-control" id="bookQuantity" min="1" required>
            </div>
            <div class="mb-3">
              <label class="form-label">价格</label>
              <input type="number" class="form-control" id="bookPrice" step="0.01">
            </div>
            <div class="mb-3">
              <label class="form-label">简介</label>
              <textarea class="form-control" id="bookDescription" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
          <button type="button" class="btn btn-primary" onclick="addBook()">确认入库</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 提示框 -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="toast" class="toast align-items-center text-white bg-primary border-0" role="alert">
      <div class="d-flex">
        <div class="toast-body" id="toastMessage"></div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="app.js"></script>
</body>
</html>